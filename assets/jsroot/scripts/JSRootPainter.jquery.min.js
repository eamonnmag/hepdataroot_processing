(function(){if(typeof JSROOT!="object"){var a=new Error("JSROOT is not defined");a.source="JSRootPainter.jquery.js";throw a}if(typeof d3!="object"){var a=new Error("This extension requires d3.v3.js");a.source="JSRootPainter.jquery.js";throw a}if(typeof JSROOT.Painter!="object"){var a=new Error("JSROOT.Painter not defined");a.source="JSRootPainter.jquery.js";throw a}if(typeof jQuery=="undefined"){var a=new Error("jQuery not defined ");a.source="JSRootPainter.jquery.js";throw a}JSROOT.Painter.createMenu=function(b,c){if(!c){c="root_ctx_menu"}var d={divid:c,code:"",cnt:1,funcs:{}};d.add=function(f,e,h){if(f.indexOf("header:")==0){this.code+="<li class='ui-widget-header'>"+f.substr(7)+"</li>";return}if(f=="endsub:"){this.code+="</ul></li>";return}var g="</li>";if(f.indexOf("sub:")==0){f=f.substr(4);g="<ul>"}if(typeof e=="function"){h=e;e=f}if((e==null)||(typeof e!="string")){e=f}this.code+="<li cnt='"+this.cnt+"' arg='"+e+"'>"+f+g;if(typeof h=="function"){this.funcs[this.cnt]=h}this.cnt++};d.size=function(){return this.cnt-1};d.addDrawMenu=function(j,g,h){if(g==null){g=new Array}if(g.length==0){g.push("")}this.add((g.length>1)?("sub:"+j):j,g[0],h);if(g.length<2){return}for(var f=0;f<g.length;f++){var e=g[f];if(e==""){e="&lt;dflt&gt;"}this.add(e,g[f],h)}this.add("endsub:")};d.remove=function(){$("#"+c).remove()};d.show=function(e){d.remove();document.body.onclick=function(f){d.remove()};$(document.body).append('<ul id="'+c+'">'+this.code+"</ul>");$("#"+c).css("left",e.clientX+window.pageXOffset).css("top",e.clientY+window.pageYOffset).attr("class","ctxmenu").menu({items:"> :not(.ui-widget-header)",select:function(i,j){var f=j.item.attr("arg");var g=j.item.attr("cnt");var h=g?d.funcs[g]:null;d.remove();if(typeof h=="function"){h(f)}}})};JSROOT.CallBack(b,d);return d};JSROOT.HierarchyPainter.prototype.isLastSibling=function(c){if(!c||!c._parent||!c._parent._childs){return false}var b=c._parent._childs;var d=b.indexOf(c);if(d<0){return false}while(++d<b.length){if(!("_hidden" in b[d])){return false}}return true};JSROOT.HierarchyPainter.prototype.addItemHtml=function(p,o){var q=(o==null);var c="_childs" in p;if("_hidden" in p){return}var h=this.CheckCanDo(p);if(!q){p._parent=o}var f=false;if(!c||!h.scan){if(h.expand){f=true;if(h.img1.length==0){h.img1="img_folder";h.img2="img_folderopen"}}else{if(h.display||h.execute){f=true}else{if(h.html.length>0){f=true}}}}p._img1=h.img1;p._img2=h.img2;if(p._img2==""){p._img2=p._img1}if(q&&(p._img1.length==0)){p._img1=p._img2="img_base"}if(p._img1.length==0){p._img1=c?"img_folder":"img_page"}if(p._img2.length==0){p._img2=c?"img_folderopen":"img_page"}var m=this.itemFullName(p);this["html"]+='<div item="'+m+'">';var l="";var e=q?null:p._parent;while((e!=null)&&(e!=this.h)){l='<div class="'+(this.isLastSibling(e)?"img_empty":"img_line")+'"/>'+l;e=e._parent}this["html"]+=l;var b="",d=false;if(q){}else{if(c){b=p._isopen?"img_minus":"img_plus";d=true}else{b="img_join"}}if(b.length>0){this["html"]+='<div class="'+b;if(this.isLastSibling(p)){this["html"]+="bottom"}if(d){this["html"]+=' plus_minus" style="cursor:pointer'}this["html"]+='"/>'}var k=p._isopen?p._img2:p._img1;if(k.indexOf("img_")==0){this["html"]+='<div class="'+k+'"/>'}else{this["html"]+='<img src="'+k+'" alt="" style="vertical-align:top"/>'}this["html"]+="<a";if(f||c){this["html"]+=' class="h_item"'}var n=p._name;if("_realname" in p){n=p._realname}var g="";if("_title" in p){g=p._title}if("_fullname" in p){g+="  fullname: "+p._fullname}if(g.length==0){g=n}this["html"]+=' title="'+g+'"';this["html"]+=">"+n+"</a>";if(c&&(q||p._isopen)){this["html"]+='<div class="h_childs">';for(var j in p._childs){this.addItemHtml(p._childs[j],p)}this["html"]+="</div>"}this["html"]+="</div>"};JSROOT.HierarchyPainter.prototype.RefreshHtml=function(g){if(this.frameid==null){return JSROOT.CallBack(g)}var d=$("#"+this.frameid);if((this.h==null)||(d.length==0)){d.html("");return JSROOT.CallBack(g)}var f=this.FindFastCommands();this["html"]="";if(f){for(var e in f){this["html"]+="<button class='fast_command'> </button>"}}this["html"]+="<p>";this["html"]+="<a href='#open_all'>open all</a>";this["html"]+="| <a href='#close_all'>close all</a>";if("_online" in this.h){this["html"]+="| <a href='#reload'>reload</a>"}else{this["html"]+="<a/>"}if("disp_kind" in this){this["html"]+="| <a href='#clear'>clear</a>"}else{this["html"]+="<a/>"}this["html"]+="</p>";this["html"]+='<div class="h_tree">';this.addItemHtml(this.h,null);this["html"]+="</div>";var c=this;var b=d.html(this["html"]).find(".h_item").click(function(){c.tree_click($(this))});if("disp_kind" in c){if(JSROOT.gStyle.DragAndDrop){b.draggable({revert:"invalid",appendTo:"body",helper:"clone"})}if(JSROOT.gStyle.ContextMenu){b.on("contextmenu",function(h){c.tree_contextmenu($(this),h)})}}d.find(".plus_minus").click(function(){c.tree_click($(this),true)});d.find("a").first().click(function(){c.toggle(true);return false}).next().click(function(){c.toggle(false);return false}).next().click(function(){c.reload();return false}).next().click(function(){c.clear(false);return false});if(f){d.find(".fast_command").each(function(h){if("_icon" in f[h]){$(this).text("").append('<img src="'+f[h]["_icon"]+'"/>')}$(this).button().attr("item",c.itemFullName(f[h])).attr("title",f[h]._title).click(function(){c.ExecuteCommand($(this).attr("item"),$(this))})})}JSROOT.CallBack(g)};JSROOT.HierarchyPainter.prototype.UpdateTreeNode=function(c,o){var b="_childs" in o;var d=o._isopen?o._img2:o._img1;var m=o._isopen?o._img1:o._img2;var g=c.find("a").first().prev();if(d.indexOf("img_")<0){g.attr("src",d)}else{if(d!=m){g.switchClass(m,d)}}g=g.prev();var j=this;var e=o._isopen?"img_minus":"img_plus";if(this.isLastSibling(o)){e+="bottom"}if(g.hasClass("plus_minus")){g.attr("class",e+" plus_minus")}else{if(b){g.attr("class",e+" plus_minus");g.css("cursor","pointer");g.click(function(){j.tree_click($(this),true)})}}var l=c.children().last();if(l.hasClass("h_childs")){l.remove()}var n=b&&o._isopen;if(!n){return}this["html"]='<div class="h_childs">';for(var f in o._childs){this.addItemHtml(o._childs[f],o)}this["html"]+="</div>";c.append(this["html"]);l=c.children().last();var k=l.find(".h_item").click(function(){j.tree_click($(this))});if("disp_kind" in j){if(JSROOT.gStyle.DragAndDrop){k.draggable({revert:"invalid",appendTo:"body",helper:"clone"})}if(JSROOT.gStyle.ContextMenu){k.on("contextmenu",function(h){j.tree_contextmenu($(this),h)})}}l.find(".plus_minus").click(function(){j.tree_click($(this),true)})};JSROOT.HierarchyPainter.prototype.tree_click=function(d,e){var f=d.parent().attr("item");if(f==null){return}var b=this.Find(f);if(b==null){return}if(!e){var c=this.CheckCanDo(b);if(c.open&&(c.html.length>0)){return window.open(c.html)}if(c.expand&&(b._childs==null)){return this.expand(f,b,d.parent())}if(c.display){return this.display(f)}if(c.execute){return this.ExecuteCommand(f,d)}if(!("_childs" in b)||(b===this.h)){return}}if(b._isopen){delete b._isopen}else{b._isopen=true}this.UpdateTreeNode(d.parent(),b)};JSROOT.HierarchyPainter.prototype.tree_contextmenu=function(d,c){c.preventDefault();var g=d.parent().attr("item");var j=this.Find(g);if(j==null){return}var e=this.CheckCanDo(j);var i=this;var h=i.GetOnlineProp(g);var b=i.GetFileProp(g);function f(k){function m(n){return n.split("&").join("&amp;").split("<").join("&lt;").split('"').join("&quot;")}var l=document.createElement("div");l.innerHTML='<a href="'+m(k)+'">x</a>';return l.firstChild.href}JSROOT.Painter.createMenu(function(q){if(g==""){var r="",l=0;function p(){return l++>0?"&":"?"}var n=[];i.ForEachRootFile(function(s){n.push(s._file.fFullURL)});if(i.GetTopOnlineItem()==null){r=JSROOT.source_dir+"index.htm"}if(i.IsMonitoring()){r+=p()+"monitoring="+i.MonitoringInterval()}if(n.length==1){r+=p()+"file="+n[0]}else{if(n.length>1){r+=p()+"files="+JSON.stringify(n)}}if(i.disp_kind){r+=p()+"layout="+i.disp_kind.replace(/ /g,"")}var k=[];if(i.disp!=null){i.disp.ForEachPainter(function(s){if(s.GetItemName()!=null){k.push(s.GetItemName())}})}if(k.length==1){r+=p()+"item="+k[0]}else{if(k.length>1){r+=p()+"items="+JSON.stringify(k)}}q.add("Direct link",function(){window.open(r)});q.add("Only items",function(){window.open(r+"&nobrowser")})}else{if(h!=null){i.FillOnlineMenu(q,h,g)}else{if(b!=null){var m=JSROOT.getDrawOptions(e.typename,"nosame");q.addDrawMenu("Draw",m,function(s){i.display(g,s)});var o=f(b.fileurl);if(o.indexOf(JSROOT.source_dir)==0){o=o.slice(JSROOT.source_dir.length)}q.addDrawMenu("Draw in new window",m,function(s){window.open(JSROOT.source_dir+"index.htm?nobrowser&file="+o+"&item="+b.itemname+"&opt="+s)})}}}if(q.size()>0){q.tree_node=d;q.add("Close");q.show(c)}});return false};JSROOT.HierarchyPainter.prototype.expand=function(e,c,d){var b=this;if(d==null){d=$("#"+this.frameid).find("[item='"+e+"']")}if(d.length==0){return console.log("Did not found node with item = "+e)}if(c==null){c=this.Find(e)}if(c==null){return}c._doing_expand=true;this.get(e,function(f,h){delete c._doing_expand;if((f==null)||(h==null)){return}var g=f;while(g!=null){if(("_expand" in g)&&(typeof(g._expand)=="function")){if(g._expand(f,h)){var i=b.itemFullName(f);d.attr("item",i);d.find("a").text(f._name);f._isopen=true;b.UpdateTreeNode(d,f)}return}g=("_parent" in g)?g._parent:null}})};JSROOT.HierarchyPainter.prototype.CreateDisplay=function(b){if("disp" in this){if(this["disp"].NumDraw()>0){return JSROOT.CallBack(b,this["disp"])}this["disp"].Reset();delete this["disp"]}if(document.getElementById(this["disp_frameid"])==null){return JSROOT.CallBack(b,null)}if(this["disp_kind"]=="tabs"){this["disp"]=new JSROOT.TabsDisplay(this["disp_frameid"])}else{if(this["disp_kind"].search("grid")==0){this["disp"]=new JSROOT.GridDisplay(this["disp_frameid"],this["disp_kind"])}else{if(this["disp_kind"]=="simple"){this["disp"]=new JSROOT.SimpleDisplay(this["disp_frameid"])}else{this["disp"]=new JSROOT.CollapsibleDisplay(this["disp_frameid"])}}}JSROOT.CallBack(b,this["disp"])};JSROOT.HierarchyPainter.prototype.enable_dropping=function(c,d){var b=this;if(JSROOT.gStyle.DragAndDrop){$(c).droppable({hoverClass:"ui-state-active",accept:function(g){var f=g.parent().attr("item");if((f==d)||(f==null)){return false}var e=b.Find(f);if((e==null)||(!("_kind" in e))){return false}return e._kind.indexOf("ROOT.")==0},drop:function(f,g){var e=g.draggable.parent().attr("item");if(e==null){return false}return b.dropitem(e,$(this).attr("id"))}})}};JSROOT.CollapsibleDisplay=function(b){JSROOT.MDIDisplay.call(this,b);this.cnt=0};JSROOT.CollapsibleDisplay.prototype=Object.create(JSROOT.MDIDisplay.prototype);JSROOT.CollapsibleDisplay.prototype.ForEachFrame=function(c,d){var b=this.frameid+"_collapsible";if(document.getElementById(b)==null){return}if(typeof c!="function"){return}$("#"+b+" .collapsible_draw").each(function(){if(d&&$(this).is(":hidden")){return}c($(this).get(0))})};JSROOT.CollapsibleDisplay.prototype.ActivateFrame=function(b){if($(b).is(":hidden")){$(b).prev().toggleClass("ui-accordion-header-active ui-state-active ui-state-default ui-corner-bottom").find("> .ui-icon").toggleClass("ui-icon-triangle-1-e ui-icon-triangle-1-s").end().next().toggleClass("ui-accordion-content-active").slideDown(0)}$(b).prev()[0].scrollIntoView()};JSROOT.CollapsibleDisplay.prototype.CreateFrame=function(f){var d=this.frameid+"_collapsible";if(document.getElementById(d)==null){$("#right-div").append('<div id="'+d+'" class="ui-accordion ui-accordion-icons ui-widget ui-helper-reset" style="overflow:auto; overflow-y:scroll; height:100%; padding-left: 2px; padding-right: 2px"></div>')}var c=d+"_sub"+this.cnt++;var e=c+"h";var b='<h5 id="'+e+'"><a> '+f+"</a>&nbsp; </h5>\n";b+="<div class='collapsible_draw' id='"+c+"'></div>\n";$("#"+d).append(b);$("#"+e).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-top ui-corner-bottom").hover(function(){$(this).toggleClass("ui-state-hover")}).prepend('<span class="ui-icon ui-icon-triangle-1-e"></span>').append('<button type="button" class="closeButton" title="close canvas" onclick="javascript: $(this).parent().next().andSelf().remove();"><img class="img_remove" src="" alt=""/></button>').click(function(){$(this).toggleClass("ui-accordion-header-active ui-state-active ui-state-default ui-corner-bottom").find("> .ui-icon").toggleClass("ui-icon-triangle-1-e ui-icon-triangle-1-s").end().next().toggleClass("ui-accordion-content-active").slideToggle(0);return false}).next().addClass("ui-accordion-content  ui-helper-reset ui-widget-content ui-corner-bottom").hide();$("#"+e).toggleClass("ui-accordion-header-active ui-state-active ui-state-default ui-corner-bottom").find("> .ui-icon").toggleClass("ui-icon-triangle-1-e ui-icon-triangle-1-s").end().next().toggleClass("ui-accordion-content-active").slideToggle(0);$("#"+c).prop("title",f);return $("#"+c).get(0)};JSROOT.TabsDisplay=function(b){JSROOT.MDIDisplay.call(this,b);this.cnt=0};JSROOT.TabsDisplay.prototype=Object.create(JSROOT.MDIDisplay.prototype);JSROOT.TabsDisplay.prototype.ForEachFrame=function(c,f){var b=this.frameid+"_tabs";if(document.getElementById(b)==null){return}if(typeof c!="function"){return}var d=-1;var e=$("#"+b).tabs("option","active");$("#"+b+" .tabs_draw").each(function(){if(f&&(d++!=e)){return}c($(this).get(0))})};JSROOT.TabsDisplay.prototype.ActivateFrame=function(c){var b=0,d=-1;this.ForEachFrame(function(e){if($(e).attr("id")==$(c).attr("id")){d=b}b++});$("#"+this.frameid+"_tabs").tabs("option","active",d)};JSROOT.TabsDisplay.prototype.CreateFrame=function(g){var e=this.frameid+"_tabs";var d=e+"_sub"+this.cnt++;var c='<li><a href="#'+d+'">'+g+'</a><span class="ui-icon ui-icon-close" role="presentation">Remove Tab</span></li>';var b='<div class="tabs_draw" id="'+d+'"></div>';if(document.getElementById(e)==null){$("#"+this.frameid).append('<div id="'+e+'"> <ul>'+c+" </ul>"+b+"</div>");var f=$("#"+e).css("overflow","hidden").tabs({heightStyle:"fill"});f.delegate("span.ui-icon-close","click",function(){var h=$(this).closest("li").remove().attr("aria-controls");$("#"+h).remove();f.tabs("refresh")})}else{$("#"+e).find(".ui-tabs-nav").append(c);$("#"+e).append(b);$("#"+e).tabs("refresh");$("#"+e).tabs("option","active",-1)}$("#"+d).empty();$("#"+d).prop("title",g);return $("#"+d).get(0)};JSROOT.TTreePlayer=function(b){JSROOT.TBasePainter.call(this);this.SetItemName(b);this.hpainter=null;return this};JSROOT.TTreePlayer.prototype=Object.create(JSROOT.TBasePainter.prototype);JSROOT.TTreePlayer.prototype.Show=function(c){this.drawid=c+"_draw";$("#"+c).html("<div class='treedraw_buttons' style='padding-left:0.5em'><button class='treedraw_exe'>Draw</button> Expr:<input class='treedraw_varexp' style='width:12em'></input> <button class='treedraw_more'>More</button></div><div id='"+this.drawid+"' style='width:100%'></div>");var b=this;$("#"+c).find(".treedraw_exe").click(function(){b.PerformDraw()});$("#"+c).find(".treedraw_varexp").val("px:py").keyup(function(d){if(d.keyCode==13){b.PerformDraw()}});$("#"+c).find(".treedraw_more").click(function(){$(this).remove();$("#"+c).find(".treedraw_buttons").append(" Cut:<input class='treedraw_cut' style='width:8em'></input> Opt:<input class='treedraw_opt' style='width:5em'></input> Num:<input class='treedraw_number' style='width:7em'></input> First:<input class='treedraw_first' style='width:7em'></input>");$("#"+c+" .treedraw_opt").val("");$("#"+c+" .treedraw_number").val("").spinner({numberFormat:"n",min:0,page:1000});$("#"+c+" .treedraw_first").val("").spinner({numberFormat:"n",min:0,page:1000})});this.CheckResize();this.SetDivId(c)};JSROOT.TTreePlayer.prototype.PerformDraw=function(){var d=$("#"+this.divid);var c=this.GetItemName()+"/exe.json.gz?compact=3&method=Draw";var l=d.find(".treedraw_varexp").val();var b="h_tree_draw";var i=l.indexOf(">>");if(i<0){l+=">>"+b}else{b=l.substr(i+2);if(b[0]=="+"){b=b.substr(1)}var j=b.indexOf("(");if(j>0){b=b.substr(0,j)}}if(d.find(".treedraw_more").length==0){var k=d.find(".treedraw_cut").val();var e=d.find(".treedraw_opt").val();var g=d.find(".treedraw_number").val();var f=d.find(".treedraw_first").val();c+='&prototype="const char*,const char*,Option_t*,Long64_t,Long64_t"&varexp="'+l+'"&selection="'+k+'"';if((e!="")||(g!="")||(f!="")){if(g==""){g="1000000000"}if(f==""){f="0"}c+='&option="'+e+'"&nentries='+g+"&firstentry="+f}}else{c+='&prototype="Option_t*"&opt="'+l+'"'}c+="&_ret_object_="+b;var m=this;var h=JSROOT.NewHttpRequest(c,"object",function(n){if(n==0){return}$("#"+m.drawid).empty();m.hpainter=JSROOT.draw(m.drawid,n)});h.send()};JSROOT.TTreePlayer.prototype.CheckResize=function(d){$("#"+this.drawid).width($("#"+this.divid).width());var c=$("#"+this.divid).height();var b=$("#"+this.divid+" .treedraw_buttons").height();if(c>b+30){$("#"+this.drawid).height(c-1-b)}if(this.hpainter){this.hpainter.CheckResize(d)}};JSROOT.drawTreePlayer=function(c,g){var f=c.GetDisplay();if(f==null){return null}var d=f.FindFrame(g,true);if(d==null){return null}var e=d3.select(d).attr("id");var b=new JSROOT.TTreePlayer(g);b.Show(e);return b};JSROOT.ConfigureVSeparator=function(d,f,e,g){if(!f){f="left-div"}if(!e){e="separator-div"}if(!g){g="right-div"}function c(k,i){var j=$("#"+f).outerWidth()-$("#"+f).width();var h=JSROOT.touches?10:4;$("#"+e).css("left",k.toString()+"px").width(h);$("#"+f).width(k-j-1);$("#"+g).css("left",(k+h).toString()+"px");if(i||(d==null)){return}if(typeof d=="function"){d()}else{if((typeof d=="object")&&(typeof d.CheckResize=="function")){d.CheckResize()}}}$("#"+e).draggable({axis:"x",zIndex:100,cursor:"ew-resize",helper:function(){return $("#"+e).clone().css("background-color","grey")},stop:function(h,i){h.stopPropagation();c(i.position.left,false)}});var b=Math.round($(window).width()*0.2);if(b<300){b=Math.min(300,Math.round($(window).width()*0.5))}c(b,true)}})();